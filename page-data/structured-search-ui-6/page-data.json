{"componentChunkName":"component---src-templates-blog-post-js","path":"/structured-search-ui-6/","result":{"data":{"site":{"siteMetadata":{"title":"jsh"}},"markdownRemark":{"id":"8900fcc1-7c65-515e-a7e4-faee2d8a5110","excerpt":"We’ll hand-wave a few things — typeahead and popover behaviour are fairly easy to solve — in favour of covering the challenges that were specific to…","html":"<p>We’ll hand-wave a few things — typeahead and popover behaviour are fairly easy to solve — in favour of covering the challenges that were specific to representing our query language in a structured, editable UI.</p>\n<p>Every time we receive new input from the editor, we’ll want to parse the new document we receive as a result of the input, and transform that <em>back</em> into a ProseMirror document again, ensuring our input reflects our parsed output. If the parse fails, we can simply accept the input as it stood, keeping the error information to display to the user.</p>\n<p>// Full parse workflow</p>\n<p><svg id=\"mermaid-0\" width=\"100%\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" class=\"flowchart\" style=\"max-width: 393.5px;\" viewBox=\"0 0 393.5 955.375\" role=\"graphics-document document\" aria-roledescription=\"flowchart-v2\"><style>#mermaid-0{font-family:arial,sans-serif;font-size:16px;fill:#000000;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-0 .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-0 .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-0 .error-icon{fill:#552222;}#mermaid-0 .error-text{fill:#552222;stroke:#552222;}#mermaid-0 .edge-thickness-normal{stroke-width:1px;}#mermaid-0 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-0 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-0 .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-0 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-0 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-0 .marker{fill:#666;stroke:#666;}#mermaid-0 .marker.cross{stroke:#666;}#mermaid-0 svg{font-family:arial,sans-serif;font-size:16px;}#mermaid-0 p{margin:0;}#mermaid-0 .label{font-family:arial,sans-serif;color:#000000;}#mermaid-0 .cluster-label text{fill:#333;}#mermaid-0 .cluster-label span{color:#333;}#mermaid-0 .cluster-label span p{background-color:transparent;}#mermaid-0 .label text,#mermaid-0 span{fill:#000000;color:#000000;}#mermaid-0 .node rect,#mermaid-0 .node circle,#mermaid-0 .node ellipse,#mermaid-0 .node polygon,#mermaid-0 .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-0 .rough-node .label text,#mermaid-0 .node .label text,#mermaid-0 .image-shape .label,#mermaid-0 .icon-shape .label{text-anchor:middle;}#mermaid-0 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-0 .rough-node .label,#mermaid-0 .node .label,#mermaid-0 .image-shape .label,#mermaid-0 .icon-shape .label{text-align:center;}#mermaid-0 .node.clickable{cursor:pointer;}#mermaid-0 .root .anchor path{fill:#666!important;stroke-width:0;stroke:#666;}#mermaid-0 .arrowheadPath{fill:#333333;}#mermaid-0 .edgePath .path{stroke:#666;stroke-width:2.0px;}#mermaid-0 .flowchart-link{stroke:#666;fill:none;}#mermaid-0 .edgeLabel{background-color:white;text-align:center;}#mermaid-0 .edgeLabel p{background-color:white;}#mermaid-0 .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-0 .labelBkg{background-color:rgba(255, 255, 255, 0.5);}#mermaid-0 .cluster rect{fill:hsl(0, 0%, 98.9215686275%);stroke:#707070;stroke-width:1px;}#mermaid-0 .cluster text{fill:#333;}#mermaid-0 .cluster span{color:#333;}#mermaid-0 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:arial,sans-serif;font-size:12px;background:hsl(-160, 0%, 93.3333333333%);border:1px solid #707070;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-0 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#000000;}#mermaid-0 rect.text{fill:none;stroke-width:0;}#mermaid-0 .icon-shape,#mermaid-0 .image-shape{background-color:white;text-align:center;}#mermaid-0 .icon-shape p,#mermaid-0 .image-shape p{background-color:white;padding:2px;}#mermaid-0 .icon-shape rect,#mermaid-0 .image-shape rect{opacity:0.5;background-color:white;fill:white;}#mermaid-0 .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#mermaid-0 .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#mermaid-0 .node rect{fill:#fff;stroke:#ddd;stroke-width:2px;stroke-linejoin:round;}#mermaid-0 path.edge-thickness-normal{stroke:#ddd;stroke-width:2px;}#mermaid-0 .marker{stroke:#bbb!important;fill:#bbb!important;stroke-width:3px!important;}#mermaid-0 *{font-family:'Lora',sans-serif;}#mermaid-0 :root{--mermaid-font-family:arial,sans-serif;}</style><g><marker id=\"mermaid-0_flowchart-v2-pointEnd\" class=\"marker flowchart-v2\" viewBox=\"0 0 10 10\" refX=\"5\" refY=\"5\" markerUnits=\"userSpaceOnUse\" markerWidth=\"8\" markerHeight=\"8\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowMarkerPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker><marker id=\"mermaid-0_flowchart-v2-pointStart\" class=\"marker flowchart-v2\" viewBox=\"0 0 10 10\" refX=\"4.5\" refY=\"5\" markerUnits=\"userSpaceOnUse\" markerWidth=\"8\" markerHeight=\"8\" orient=\"auto\"><path d=\"M 0 5 L 10 10 L 10 0 z\" class=\"arrowMarkerPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker><marker id=\"mermaid-0_flowchart-v2-circleEnd\" class=\"marker flowchart-v2\" viewBox=\"0 0 10 10\" refX=\"11\" refY=\"5\" markerUnits=\"userSpaceOnUse\" markerWidth=\"11\" markerHeight=\"11\" orient=\"auto\"><circle cx=\"5\" cy=\"5\" r=\"5\" class=\"arrowMarkerPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></circle></marker><marker id=\"mermaid-0_flowchart-v2-circleStart\" class=\"marker flowchart-v2\" viewBox=\"0 0 10 10\" refX=\"-1\" refY=\"5\" markerUnits=\"userSpaceOnUse\" markerWidth=\"11\" markerHeight=\"11\" orient=\"auto\"><circle cx=\"5\" cy=\"5\" r=\"5\" class=\"arrowMarkerPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></circle></marker><marker id=\"mermaid-0_flowchart-v2-crossEnd\" class=\"marker cross flowchart-v2\" viewBox=\"0 0 11 11\" refX=\"12\" refY=\"5.2\" markerUnits=\"userSpaceOnUse\" markerWidth=\"11\" markerHeight=\"11\" orient=\"auto\"><path d=\"M 1,1 l 9,9 M 10,1 l -9,9\" class=\"arrowMarkerPath\" style=\"stroke-width: 2; stroke-dasharray: 1, 0;\"></path></marker><marker id=\"mermaid-0_flowchart-v2-crossStart\" class=\"marker cross flowchart-v2\" viewBox=\"0 0 11 11\" refX=\"-1\" refY=\"5.2\" markerUnits=\"userSpaceOnUse\" markerWidth=\"11\" markerHeight=\"11\" orient=\"auto\"><path d=\"M 1,1 l 9,9 M 10,1 l -9,9\" class=\"arrowMarkerPath\" style=\"stroke-width: 2; stroke-dasharray: 1, 0;\"></path></marker><g class=\"root\"><g class=\"clusters\"></g><g class=\"edgePaths\"><path d=\"M185.695,62L177.746,68.167C169.797,74.333,153.898,86.667,145.949,98.333C138,110,138,121,138,126.5L138,132\" id=\"L_U_D1_0\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" style=\";\" data-edge=\"true\" data-et=\"edge\" data-id=\"L_U_D1_0\" data-points=\"W3sieCI6MTg1LjY5NTMxMjUsInkiOjYyfSx7IngiOjEzOCwieSI6OTl9LHsieCI6MTM4LCJ5IjoxMzZ9XQ==\" marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\"></path><path d=\"M138,214L138,220.167C138,226.333,138,238.667,138,250.333C138,262,138,273,138,278.5L138,284\" id=\"L_D1_Q1_0\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" style=\";\" data-edge=\"true\" data-et=\"edge\" data-id=\"L_D1_Q1_0\" data-points=\"W3sieCI6MTM4LCJ5IjoyMTR9LHsieCI6MTM4LCJ5IjoyNTF9LHsieCI6MTM4LCJ5IjoyODh9XQ==\" marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\"></path><path d=\"M138,342L138,348.167C138,354.333,138,366.667,138,378.333C138,390,138,401,138,406.5L138,412\" id=\"L_Q1_S_0\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" style=\";\" data-edge=\"true\" data-et=\"edge\" data-id=\"L_Q1_S_0\" data-points=\"W3sieCI6MTM4LCJ5IjozNDJ9LHsieCI6MTM4LCJ5IjozNzl9LHsieCI6MTM4LCJ5Ijo0MTZ9XQ==\" marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\"></path><path d=\"M166.088,511.287L175.157,522.135C184.225,532.983,202.363,554.679,211.431,571.027C220.5,587.375,220.5,598.375,220.5,603.875L220.5,609.375\" id=\"L_S_A1_0\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" style=\";\" data-edge=\"true\" data-et=\"edge\" data-id=\"L_S_A1_0\" data-points=\"W3sieCI6MTY2LjA4ODEzMzgzOTI1NDksInkiOjUxMS4yODY4NjYxNjA3NDUxfSx7IngiOjIyMC41LCJ5Ijo1NzYuMzc1fSx7IngiOjIyMC41LCJ5Ijo2MTMuMzc1fV0=\" marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\"></path><path d=\"M109.912,511.287L100.843,522.135C91.775,532.983,73.637,554.679,64.569,576.194C55.5,597.708,55.5,619.042,55.5,640.375C55.5,661.708,55.5,683.042,55.5,706.375C55.5,729.708,55.5,755.042,55.5,780.375C55.5,805.708,55.5,831.042,73.007,850.499C90.515,869.956,125.529,883.538,143.037,890.329L160.544,897.119\" id=\"L_S_UI1_0\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" style=\";\" data-edge=\"true\" data-et=\"edge\" data-id=\"L_S_UI1_0\" data-points=\"W3sieCI6MTA5LjkxMTg2NjE2MDc0NTA4LCJ5Ijo1MTEuMjg2ODY2MTYwNzQ1MX0seyJ4Ijo1NS41LCJ5Ijo1NzYuMzc1fSx7IngiOjU1LjUsInkiOjY0MC4zNzV9LHsieCI6NTUuNSwieSI6NzA0LjM3NX0seyJ4Ijo1NS41LCJ5Ijo3ODAuMzc1fSx7IngiOjU1LjUsInkiOjg1Ni4zNzV9LHsieCI6MTY0LjI3MzQzNzUsInkiOjg5OC41NjU5MDkwOTA5MDkxfV0=\" marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\"></path><path d=\"M220.5,667.375L220.5,673.542C220.5,679.708,220.5,692.042,220.5,703.708C220.5,715.375,220.5,726.375,220.5,731.875L220.5,737.375\" id=\"L_A1_D2_0\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" style=\";\" data-edge=\"true\" data-et=\"edge\" data-id=\"L_A1_D2_0\" data-points=\"W3sieCI6MjIwLjUsInkiOjY2Ny4zNzV9LHsieCI6MjIwLjUsInkiOjcwNC4zNzV9LHsieCI6MjIwLjUsInkiOjc0MS4zNzV9XQ==\" marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\"></path><path d=\"M220.5,819.375L220.5,825.542C220.5,831.708,220.5,844.042,220.5,855.708C220.5,867.375,220.5,878.375,220.5,883.875L220.5,889.375\" id=\"L_D2_UI1_0\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" style=\";\" data-edge=\"true\" data-et=\"edge\" data-id=\"L_D2_UI1_0\" data-points=\"W3sieCI6MjIwLjUsInkiOjgxOS4zNzV9LHsieCI6MjIwLjUsInkiOjg1Ni4zNzV9LHsieCI6MjIwLjUsInkiOjg5My4zNzV9XQ==\" marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\"></path><path d=\"M276.727,898.566L294.855,891.534C312.984,884.502,349.242,870.439,367.371,850.74C385.5,831.042,385.5,805.708,385.5,780.375C385.5,755.042,385.5,729.708,385.5,706.375C385.5,683.042,385.5,661.708,385.5,640.375C385.5,619.042,385.5,597.708,385.5,570.594C385.5,543.479,385.5,510.583,385.5,477.688C385.5,444.792,385.5,411.896,385.5,384.781C385.5,357.667,385.5,336.333,385.5,315C385.5,293.667,385.5,272.333,385.5,249C385.5,225.667,385.5,200.333,385.5,175C385.5,149.667,385.5,124.333,370.223,105.741C354.946,87.149,324.392,75.298,309.116,69.372L293.839,63.447\" id=\"L_UI1_U_0\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" style=\";\" data-edge=\"true\" data-et=\"edge\" data-id=\"L_UI1_U_0\" data-points=\"W3sieCI6Mjc2LjcyNjU2MjUsInkiOjg5OC41NjU5MDkwOTA5MDkxfSx7IngiOjM4NS41LCJ5Ijo4NTYuMzc1fSx7IngiOjM4NS41LCJ5Ijo3ODAuMzc1fSx7IngiOjM4NS41LCJ5Ijo3MDQuMzc1fSx7IngiOjM4NS41LCJ5Ijo2NDAuMzc1fSx7IngiOjM4NS41LCJ5Ijo1NzYuMzc1fSx7IngiOjM4NS41LCJ5Ijo0NzcuNjg3NX0seyJ4IjozODUuNSwieSI6Mzc5fSx7IngiOjM4NS41LCJ5IjozMTV9LHsieCI6Mzg1LjUsInkiOjI1MX0seyJ4IjozODUuNSwieSI6MTc1fSx7IngiOjM4NS41LCJ5Ijo5OX0seyJ4IjoyOTAuMTA5Mzc1LCJ5Ijo2Mn1d\" marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\"></path></g><g class=\"edgeLabels\"><g class=\"edgeLabel\" transform=\"translate(138, 99)\"><g class=\"label\" data-id=\"L_U_D1_0\" transform=\"translate(-54.8671875, -12)\"><foreignObject width=\"109.734375\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"labelBkg\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"edgeLabel\"><p>e.g 'keydown +'</p></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"translate(138, 251)\"><g class=\"label\" data-id=\"L_D1_Q1_0\" transform=\"translate(-60.46875, -12)\"><foreignObject width=\"120.9375\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"labelBkg\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"edgeLabel\"><p>docToCqlQuery()</p></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"translate(138, 379)\"><g class=\"label\" data-id=\"L_Q1_S_0\" transform=\"translate(-25.34375, -12)\"><foreignObject width=\"50.6875\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"labelBkg\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"edgeLabel\"><p>parse()</p></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"translate(220.5, 576.375)\"><g class=\"label\" data-id=\"L_S_A1_0\" transform=\"translate(-13.0546875, -12)\"><foreignObject width=\"26.109375\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"labelBkg\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"edgeLabel\"><p>Yes</p></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"translate(55.5, 704.375)\"><g class=\"label\" data-id=\"L_S_UI1_0\" transform=\"translate(-10.2265625, -12)\"><foreignObject width=\"20.453125\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"labelBkg\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"edgeLabel\"><p>No</p></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"translate(220.5, 704.375)\"><g class=\"label\" data-id=\"L_A1_D2_0\" transform=\"translate(-60.015625, -12)\"><foreignObject width=\"120.03125\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"labelBkg\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"edgeLabel\"><p>cqlQueryToDoc()</p></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"translate(220.5, 856.375)\"><g class=\"label\" data-id=\"L_D2_UI1_0\" transform=\"translate(-24.453125, -12)\"><foreignObject width=\"48.90625\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"labelBkg\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"edgeLabel\"><p>apply()</p></span></div></foreignObject></g></g><g class=\"edgeLabel\"><g class=\"label\" data-id=\"L_UI1_U_0\" transform=\"translate(0, 0)\"><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"labelBkg\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"edgeLabel\"></span></div></foreignObject></g></g></g><g class=\"nodes\"><g class=\"node default\" id=\"flowchart-U-0\" transform=\"translate(220.5, 35)\"><rect class=\"basic label-container\" style=\"\" x=\"-83.359375\" y=\"-27\" width=\"166.71875\" height=\"54\"></rect><g class=\"label\" style=\"\" transform=\"translate(-53.359375, -12)\"><rect></rect><foreignObject width=\"106.71875\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"nodeLabel\"><p>New user input</p></span></div></foreignObject></g></g><g class=\"node default\" id=\"flowchart-D1-1\" transform=\"translate(138, 175)\"><rect class=\"basic label-container\" style=\"\" x=\"-130\" y=\"-39\" width=\"260\" height=\"78\"></rect><g class=\"label\" style=\"\" transform=\"translate(-100, -24)\"><rect></rect><foreignObject width=\"200\" height=\"48\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;\"><span class=\"nodeLabel\"><p>New document state (unparsed)</p></span></div></foreignObject></g></g><g class=\"node default\" id=\"flowchart-Q1-3\" transform=\"translate(138, 315)\"><rect class=\"basic label-container\" style=\"\" x=\"-68.2421875\" y=\"-27\" width=\"136.484375\" height=\"54\"></rect><g class=\"label\" style=\"\" transform=\"translate(-38.2421875, -12)\"><rect></rect><foreignObject width=\"76.484375\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"nodeLabel\"><p>New query</p></span></div></foreignObject></g></g><g class=\"node default\" id=\"flowchart-S-5\" transform=\"translate(138, 477.6875)\"><polygon points=\"61.6875,0 123.375,-61.6875 61.6875,-123.375 0,-61.6875\" class=\"label-container\" transform=\"translate(-61.1875, 61.6875)\"></polygon><g class=\"label\" style=\"\" transform=\"translate(-34.6875, -12)\"><rect></rect><foreignObject width=\"69.375\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"nodeLabel\"><p>Success?</p></span></div></foreignObject></g></g><g class=\"node default\" id=\"flowchart-A1-7\" transform=\"translate(220.5, 640.375)\"><rect class=\"basic label-container\" style=\"\" x=\"-63.3515625\" y=\"-27\" width=\"126.703125\" height=\"54\"></rect><g class=\"label\" style=\"\" transform=\"translate(-33.3515625, -12)\"><rect></rect><foreignObject width=\"66.703125\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"nodeLabel\"><p>New AST</p></span></div></foreignObject></g></g><g class=\"node default\" id=\"flowchart-UI1-9\" transform=\"translate(220.5, 920.375)\"><rect class=\"basic label-container\" style=\"\" x=\"-56.2265625\" y=\"-27\" width=\"112.453125\" height=\"54\"></rect><g class=\"label\" style=\"\" transform=\"translate(-26.2265625, -12)\"><rect></rect><foreignObject width=\"52.453125\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"nodeLabel\"><p>New UI</p></span></div></foreignObject></g></g><g class=\"node default\" id=\"flowchart-D2-11\" transform=\"translate(220.5, 780.375)\"><rect class=\"basic label-container\" style=\"\" x=\"-130\" y=\"-39\" width=\"260\" height=\"78\"></rect><g class=\"label\" style=\"\" transform=\"translate(-100, -24)\"><rect></rect><foreignObject width=\"200\" height=\"48\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;\"><span class=\"nodeLabel\"><p>New document state (from parsed query)</p></span></div></foreignObject></g></g></g></g></g></svg></p>\n<p>In code, this looks like:</p>\n<p>// Code example of pm->cql, cql->pm, plugin code</p>\n<p>As our scanner is currently implemented, this has the side-effect of normalising our input when it’s valid — extra whitespace at the start or end of queries, for example, is stripped out.</p>\n<p>//</p>\n<p>// Schema detail</p>\n<p>A schema defines its content in a similar way to our grammar in <a href=\"/structured-search-ui-2\">part 2</a>. In our grammar, on each line we declared a symbol, and a rule that defined the valid sequence(s) of terminal or nonterminals for that symbol. In our ProseMirror schema, for each node declaration, we’ll define a node name (the key within the <code class=\"language-text\">nodes</code> object), and within the <code class=\"language-text\">content</code> property of that node’s definition, we’ll define what’s permitted in the node. For now, our document can contain any number of <code class=\"language-text\">text</code> nodes — the minimum we need to support plain text input.</p>\n<p>The ecosystem provides a <a href=\"https://github.com/ProseMirror/prosemirror-schema-basic\">basic schema</a> to get you started with rich text, but schemas can be large and expressive — the Guardian uses a schema with hundreds of node types to express the many different kinds of structured content their platform supports.</p>\n<p>Structure:</p>\n<p>Reminder of the feature set we’re implementing.</p>\n<p>What we’ll need:</p>\n<ul>\n<li>parser</li>\n<li>way to wrangle contenteditable</li>\n<li>maybe a little introduction to Prosemirror</li>\n<li>cute Venn diagram of my two skills</li>\n</ul>\n<p>Structure</p>\n<p>Implement parts of structure, one after t’other</p>\n<p>????</p>\n<p>Profit</p>\n<p><svg id=\"mermaid-1\" width=\"100%\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" class=\"flowchart\" style=\"max-width: 271.25390625px;\" viewBox=\"0 0 271.25390625 710\" role=\"graphics-document document\" aria-roledescription=\"flowchart-v2\"><style>#mermaid-1{font-family:arial,sans-serif;font-size:16px;fill:#000000;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-1 .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-1 .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-1 .error-icon{fill:#552222;}#mermaid-1 .error-text{fill:#552222;stroke:#552222;}#mermaid-1 .edge-thickness-normal{stroke-width:1px;}#mermaid-1 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1 .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-1 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1 .marker{fill:#666;stroke:#666;}#mermaid-1 .marker.cross{stroke:#666;}#mermaid-1 svg{font-family:arial,sans-serif;font-size:16px;}#mermaid-1 p{margin:0;}#mermaid-1 .label{font-family:arial,sans-serif;color:#000000;}#mermaid-1 .cluster-label text{fill:#333;}#mermaid-1 .cluster-label span{color:#333;}#mermaid-1 .cluster-label span p{background-color:transparent;}#mermaid-1 .label text,#mermaid-1 span{fill:#000000;color:#000000;}#mermaid-1 .node rect,#mermaid-1 .node circle,#mermaid-1 .node ellipse,#mermaid-1 .node polygon,#mermaid-1 .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-1 .rough-node .label text,#mermaid-1 .node .label text,#mermaid-1 .image-shape .label,#mermaid-1 .icon-shape .label{text-anchor:middle;}#mermaid-1 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-1 .rough-node .label,#mermaid-1 .node .label,#mermaid-1 .image-shape .label,#mermaid-1 .icon-shape .label{text-align:center;}#mermaid-1 .node.clickable{cursor:pointer;}#mermaid-1 .root .anchor path{fill:#666!important;stroke-width:0;stroke:#666;}#mermaid-1 .arrowheadPath{fill:#333333;}#mermaid-1 .edgePath .path{stroke:#666;stroke-width:2.0px;}#mermaid-1 .flowchart-link{stroke:#666;fill:none;}#mermaid-1 .edgeLabel{background-color:white;text-align:center;}#mermaid-1 .edgeLabel p{background-color:white;}#mermaid-1 .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-1 .labelBkg{background-color:rgba(255, 255, 255, 0.5);}#mermaid-1 .cluster rect{fill:hsl(0, 0%, 98.9215686275%);stroke:#707070;stroke-width:1px;}#mermaid-1 .cluster text{fill:#333;}#mermaid-1 .cluster span{color:#333;}#mermaid-1 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:arial,sans-serif;font-size:12px;background:hsl(-160, 0%, 93.3333333333%);border:1px solid #707070;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#000000;}#mermaid-1 rect.text{fill:none;stroke-width:0;}#mermaid-1 .icon-shape,#mermaid-1 .image-shape{background-color:white;text-align:center;}#mermaid-1 .icon-shape p,#mermaid-1 .image-shape p{background-color:white;padding:2px;}#mermaid-1 .icon-shape rect,#mermaid-1 .image-shape rect{opacity:0.5;background-color:white;fill:white;}#mermaid-1 .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#mermaid-1 .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#mermaid-1 .node rect{fill:#fff;stroke:#ddd;stroke-width:2px;stroke-linejoin:round;}#mermaid-1 path.edge-thickness-normal{stroke:#ddd;stroke-width:2px;}#mermaid-1 .marker{stroke:#bbb!important;fill:#bbb!important;stroke-width:3px!important;}#mermaid-1 *{font-family:'Lora',sans-serif;}#mermaid-1 :root{--mermaid-font-family:arial,sans-serif;}</style><g><marker id=\"mermaid-1_flowchart-v2-pointEnd\" class=\"marker flowchart-v2\" viewBox=\"0 0 10 10\" refX=\"5\" refY=\"5\" markerUnits=\"userSpaceOnUse\" markerWidth=\"8\" markerHeight=\"8\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowMarkerPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker><marker id=\"mermaid-1_flowchart-v2-pointStart\" class=\"marker flowchart-v2\" viewBox=\"0 0 10 10\" refX=\"4.5\" refY=\"5\" markerUnits=\"userSpaceOnUse\" markerWidth=\"8\" markerHeight=\"8\" orient=\"auto\"><path d=\"M 0 5 L 10 10 L 10 0 z\" class=\"arrowMarkerPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker><marker id=\"mermaid-1_flowchart-v2-circleEnd\" class=\"marker flowchart-v2\" viewBox=\"0 0 10 10\" refX=\"11\" refY=\"5\" markerUnits=\"userSpaceOnUse\" markerWidth=\"11\" markerHeight=\"11\" orient=\"auto\"><circle cx=\"5\" cy=\"5\" r=\"5\" class=\"arrowMarkerPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></circle></marker><marker id=\"mermaid-1_flowchart-v2-circleStart\" class=\"marker flowchart-v2\" viewBox=\"0 0 10 10\" refX=\"-1\" refY=\"5\" markerUnits=\"userSpaceOnUse\" markerWidth=\"11\" markerHeight=\"11\" orient=\"auto\"><circle cx=\"5\" cy=\"5\" r=\"5\" class=\"arrowMarkerPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></circle></marker><marker id=\"mermaid-1_flowchart-v2-crossEnd\" class=\"marker cross flowchart-v2\" viewBox=\"0 0 11 11\" refX=\"12\" refY=\"5.2\" markerUnits=\"userSpaceOnUse\" markerWidth=\"11\" markerHeight=\"11\" orient=\"auto\"><path d=\"M 1,1 l 9,9 M 10,1 l -9,9\" class=\"arrowMarkerPath\" style=\"stroke-width: 2; stroke-dasharray: 1, 0;\"></path></marker><marker id=\"mermaid-1_flowchart-v2-crossStart\" class=\"marker cross flowchart-v2\" viewBox=\"0 0 11 11\" refX=\"-1\" refY=\"5.2\" markerUnits=\"userSpaceOnUse\" markerWidth=\"11\" markerHeight=\"11\" orient=\"auto\"><path d=\"M 1,1 l 9,9 M 10,1 l -9,9\" class=\"arrowMarkerPath\" style=\"stroke-width: 2; stroke-dasharray: 1, 0;\"></path></marker><g class=\"root\"><g class=\"clusters\"></g><g class=\"edgePaths\"><path d=\"M150.8,62L144.155,68.167C137.51,74.333,124.22,86.667,117.575,98.333C110.93,110,110.93,121,110.93,126.5L110.93,132\" id=\"L_U_D1_0\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" style=\";\" data-edge=\"true\" data-et=\"edge\" data-id=\"L_U_D1_0\" data-points=\"W3sieCI6MTUwLjc5OTk4Nzc5Mjk2ODc1LCJ5Ijo2Mn0seyJ4IjoxMTAuOTI5Njg3NSwieSI6OTl9LHsieCI6MTEwLjkyOTY4NzUsInkiOjEzNn1d\" marker-end=\"url(#mermaid-1_flowchart-v2-pointEnd)\"></path><path d=\"M110.93,190L110.93,196.167C110.93,202.333,110.93,214.667,110.93,226.333C110.93,238,110.93,249,110.93,254.5L110.93,260\" id=\"L_D1_Q1_0\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" style=\";\" data-edge=\"true\" data-et=\"edge\" data-id=\"L_D1_Q1_0\" data-points=\"W3sieCI6MTEwLjkyOTY4NzUsInkiOjE5MH0seyJ4IjoxMTAuOTI5Njg3NSwieSI6MjI3fSx7IngiOjExMC45Mjk2ODc1LCJ5IjoyNjR9XQ==\" marker-end=\"url(#mermaid-1_flowchart-v2-pointEnd)\"></path><path d=\"M110.93,318L110.93,324.167C110.93,330.333,110.93,342.667,110.93,354.333C110.93,366,110.93,377,110.93,382.5L110.93,388\" id=\"L_Q1_A1_0\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" style=\";\" data-edge=\"true\" data-et=\"edge\" data-id=\"L_Q1_A1_0\" data-points=\"W3sieCI6MTEwLjkyOTY4NzUsInkiOjMxOH0seyJ4IjoxMTAuOTI5Njg3NSwieSI6MzU1fSx7IngiOjExMC45Mjk2ODc1LCJ5IjozOTJ9XQ==\" marker-end=\"url(#mermaid-1_flowchart-v2-pointEnd)\"></path><path d=\"M110.93,446L110.93,452.167C110.93,458.333,110.93,470.667,110.93,482.333C110.93,494,110.93,505,110.93,510.5L110.93,516\" id=\"L_A1_D2_0\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" style=\";\" data-edge=\"true\" data-et=\"edge\" data-id=\"L_A1_D2_0\" data-points=\"W3sieCI6MTEwLjkyOTY4NzUsInkiOjQ0Nn0seyJ4IjoxMTAuOTI5Njg3NSwieSI6NDgzfSx7IngiOjExMC45Mjk2ODc1LCJ5Ijo1MjB9XQ==\" marker-end=\"url(#mermaid-1_flowchart-v2-pointEnd)\"></path><path d=\"M110.93,574L110.93,580.167C110.93,586.333,110.93,598.667,117.086,610.547C123.242,622.426,135.555,633.853,141.712,639.566L147.868,645.279\" id=\"L_D2_UI1_0\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" style=\";\" data-edge=\"true\" data-et=\"edge\" data-id=\"L_D2_UI1_0\" data-points=\"W3sieCI6MTEwLjkyOTY4NzUsInkiOjU3NH0seyJ4IjoxMTAuOTI5Njg3NSwieSI6NjExfSx7IngiOjE1MC43OTk5ODc3OTI5Njg3NSwieSI6NjQ4fV0=\" marker-end=\"url(#mermaid-1_flowchart-v2-pointEnd)\"></path><path d=\"M208.989,648L215.634,641.833C222.279,635.667,235.569,623.333,242.214,606.5C248.859,589.667,248.859,568.333,248.859,547C248.859,525.667,248.859,504.333,248.859,483C248.859,461.667,248.859,440.333,248.859,419C248.859,397.667,248.859,376.333,248.859,355C248.859,333.667,248.859,312.333,248.859,291C248.859,269.667,248.859,248.333,248.859,227C248.859,205.667,248.859,184.333,248.859,163C248.859,141.667,248.859,120.333,242.703,103.953C236.547,87.574,224.234,76.147,218.077,70.434L211.921,64.721\" id=\"L_UI1_U_0\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" style=\";\" data-edge=\"true\" data-et=\"edge\" data-id=\"L_UI1_U_0\" data-points=\"W3sieCI6MjA4Ljk4OTA3NDcwNzAzMTI1LCJ5Ijo2NDh9LHsieCI6MjQ4Ljg1OTM3NSwieSI6NjExfSx7IngiOjI0OC44NTkzNzUsInkiOjU0N30seyJ4IjoyNDguODU5Mzc1LCJ5Ijo0ODN9LHsieCI6MjQ4Ljg1OTM3NSwieSI6NDE5fSx7IngiOjI0OC44NTkzNzUsInkiOjM1NX0seyJ4IjoyNDguODU5Mzc1LCJ5IjoyOTF9LHsieCI6MjQ4Ljg1OTM3NSwieSI6MjI3fSx7IngiOjI0OC44NTkzNzUsInkiOjE2M30seyJ4IjoyNDguODU5Mzc1LCJ5Ijo5OX0seyJ4IjoyMDguOTg5MDc0NzA3MDMxMjUsInkiOjYyfV0=\" marker-end=\"url(#mermaid-1_flowchart-v2-pointEnd)\"></path></g><g class=\"edgeLabels\"><g class=\"edgeLabel\" transform=\"translate(110.9296875, 99)\"><g class=\"label\" data-id=\"L_U_D1_0\" transform=\"translate(-54.8671875, -12)\"><foreignObject width=\"109.734375\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"labelBkg\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"edgeLabel\"><p>e.g 'keydown +'</p></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"translate(110.9296875, 227)\"><g class=\"label\" data-id=\"L_D1_Q1_0\" transform=\"translate(-60.46875, -12)\"><foreignObject width=\"120.9375\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"labelBkg\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"edgeLabel\"><p>docToCqlQuery()</p></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"translate(110.9296875, 355)\"><g class=\"label\" data-id=\"L_Q1_A1_0\" transform=\"translate(-25.34375, -12)\"><foreignObject width=\"50.6875\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"labelBkg\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"edgeLabel\"><p>parse()</p></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"translate(110.9296875, 483)\"><g class=\"label\" data-id=\"L_A1_D2_0\" transform=\"translate(-60.015625, -12)\"><foreignObject width=\"120.03125\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"labelBkg\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"edgeLabel\"><p>cqlQueryToDoc()</p></span></div></foreignObject></g></g><g class=\"edgeLabel\" transform=\"translate(110.9296875, 611)\"><g class=\"label\" data-id=\"L_D2_UI1_0\" transform=\"translate(-24.453125, -12)\"><foreignObject width=\"48.90625\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"labelBkg\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"edgeLabel\"><p>apply()</p></span></div></foreignObject></g></g><g class=\"edgeLabel\"><g class=\"label\" data-id=\"L_UI1_U_0\" transform=\"translate(0, 0)\"><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"labelBkg\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"edgeLabel\"></span></div></foreignObject></g></g></g><g class=\"nodes\"><g class=\"node default\" id=\"flowchart-U-0\" transform=\"translate(179.89453125, 35)\"><rect class=\"basic label-container\" style=\"\" x=\"-83.359375\" y=\"-27\" width=\"166.71875\" height=\"54\"></rect><g class=\"label\" style=\"\" transform=\"translate(-53.359375, -12)\"><rect></rect><foreignObject width=\"106.71875\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"nodeLabel\"><p>New user input</p></span></div></foreignObject></g></g><g class=\"node default\" id=\"flowchart-D1-1\" transform=\"translate(110.9296875, 163)\"><rect class=\"basic label-container\" style=\"\" x=\"-102.9296875\" y=\"-27\" width=\"205.859375\" height=\"54\"></rect><g class=\"label\" style=\"\" transform=\"translate(-72.9296875, -12)\"><rect></rect><foreignObject width=\"145.859375\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"nodeLabel\"><p>New document state</p></span></div></foreignObject></g></g><g class=\"node default\" id=\"flowchart-Q1-3\" transform=\"translate(110.9296875, 291)\"><rect class=\"basic label-container\" style=\"\" x=\"-68.2421875\" y=\"-27\" width=\"136.484375\" height=\"54\"></rect><g class=\"label\" style=\"\" transform=\"translate(-38.2421875, -12)\"><rect></rect><foreignObject width=\"76.484375\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"nodeLabel\"><p>New query</p></span></div></foreignObject></g></g><g class=\"node default\" id=\"flowchart-A1-5\" transform=\"translate(110.9296875, 419)\"><rect class=\"basic label-container\" style=\"\" x=\"-63.3515625\" y=\"-27\" width=\"126.703125\" height=\"54\"></rect><g class=\"label\" style=\"\" transform=\"translate(-33.3515625, -12)\"><rect></rect><foreignObject width=\"66.703125\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"nodeLabel\"><p>New AST</p></span></div></foreignObject></g></g><g class=\"node default\" id=\"flowchart-D2-7\" transform=\"translate(110.9296875, 547)\"><rect class=\"basic label-container\" style=\"\" x=\"-102.9296875\" y=\"-27\" width=\"205.859375\" height=\"54\"></rect><g class=\"label\" style=\"\" transform=\"translate(-72.9296875, -12)\"><rect></rect><foreignObject width=\"145.859375\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"nodeLabel\"><p>New document state</p></span></div></foreignObject></g></g><g class=\"node default\" id=\"flowchart-UI1-9\" transform=\"translate(179.89453125, 675)\"><rect class=\"basic label-container\" style=\"\" x=\"-56.2265625\" y=\"-27\" width=\"112.453125\" height=\"54\"></rect><g class=\"label\" style=\"\" transform=\"translate(-26.2265625, -12)\"><rect></rect><foreignObject width=\"52.453125\" height=\"24\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\"><span class=\"nodeLabel\"><p>New UI</p></span></div></foreignObject></g></g></g></g></g></svg></p>","frontmatter":{"title":"Structured search queries for web UIs, part 6: the interface, features","date":"February 23, 2026","description":""}}},"pageContext":{"slug":"/structured-search-ui-6/","previous":{"fields":{"slug":"/structured-search-ui-5/"},"frontmatter":{"title":"Structured search queries for web UIs, part 5: the interface, foundations"}},"next":null}},"staticQueryHashes":["1240129568","63159454"],"slicesMap":{}}